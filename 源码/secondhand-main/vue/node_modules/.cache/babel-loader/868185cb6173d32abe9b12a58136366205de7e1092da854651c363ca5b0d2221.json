{"ast":null,"code":"export default {\n  name: 'Orders',\n  data() {\n    return {\n      url: 'selectPage',\n      tableData: [],\n      pageNum: 1,\n      pageSize: 10,\n      total: 0,\n      goodsName: '',\n      orderNo: '',\n      status: '',\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      statusOptions: ['已取消', '待支付', '待发货', '待收货', '已完成'],\n      statusTagType: {\n        已取消: 'danger',\n        待支付: 'danger',\n        待发货: 'primary',\n        待收货: 'info',\n        已完成: 'success'\n      }\n    };\n  },\n  created() {\n    this.load();\n  },\n  methods: {\n    /* ---------- 支付 ---------- */\n    pay(orderNo) {\n      window.open(`http://localhost:9090/alipay/pay?orderNo=${orderNo}`);\n    },\n    /* ---------- 状态更新 ---------- */\n    changeStatus(row, nextStatus) {\n      this.$confirm('您确认操作吗？', '提示', {\n        type: 'warning'\n      }).then(() => {\n        const payload = {\n          ...row,\n          status: nextStatus\n        };\n        return this.$request.put('/orders/update', payload);\n      }).then(({\n        code,\n        msg\n      }) => {\n        code === '200' ? (this.$message.success('操作成功'), this.load(1)) : this.$message.error(msg);\n      }).catch(() => {});\n    },\n    /* ---------- 列表查询 ---------- */\n    async load(page = this.pageNum) {\n      this.pageNum = page;\n      const {\n        code,\n        data,\n        msg\n      } = await this.$request.get(`/orders/${this.url}`, {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize,\n          goodsName: this.goodsName,\n          status: this.status,\n          orderNo: this.orderNo\n        }\n      });\n      if (code === '200') {\n        this.tableData = data.list;\n        this.total = data.total;\n      } else {\n        this.$message.error(msg);\n      }\n    },\n    /* ---------- 辅助 ---------- */\n    reset() {\n      this.goodsName = this.orderNo = this.status = '';\n      this.load(1);\n    },\n    handleCurrentChange(page) {\n      this.load(page);\n    }\n  }\n};","map":{"version":3,"names":["name","data","url","tableData","pageNum","pageSize","total","goodsName","orderNo","status","user","JSON","parse","localStorage","getItem","statusOptions","statusTagType","已取消","待支付","待发货","待收货","已完成","created","load","methods","pay","window","open","changeStatus","row","nextStatus","$confirm","type","then","payload","$request","put","code","msg","$message","success","error","catch","page","get","params","list","reset","handleCurrentChange"],"sources":["src/views/front/Orders.vue"],"sourcesContent":["<template>\n  <div class=\"orders-page\">\n    <!-- ▍筛选栏 -->\n    <div class=\"filter-bar\">\n      <el-radio-group v-model=\"url\" @change=\"load(1)\">\n        <el-radio-button label=\"selectPage\">我购买的订单</el-radio-button>\n        <el-radio-button label=\"selectSalePage\">我出售的订单</el-radio-button>\n      </el-radio-group>\n\n      <div class=\"filter-right\">\n        <el-input\n          v-model.trim=\"goodsName\"\n          placeholder=\"商品名称\"\n          clearable\n          class=\"w200 mr5\"\n        />\n        <el-input\n          v-model.trim=\"orderNo\"\n          placeholder=\"订单编号\"\n          clearable\n          class=\"w200 mr5\"\n        />\n        <el-select\n          v-model=\"status\"\n          placeholder=\"订单状态\"\n          clearable\n          class=\"w200 mr5\"\n        >\n          <el-option\n            v-for=\"s in statusOptions\"\n            :key=\"s\"\n            :label=\"s\"\n            :value=\"s\"\n          />\n        </el-select>\n        <el-button type=\"primary\" size=\"mini\" @click=\"load(1)\">搜索</el-button>\n        <el-button type=\"warning\" size=\"mini\" @click=\"reset\">重置</el-button>\n      </div>\n    </div>\n\n    <!-- ▍订单表格 -->\n    <el-card shadow=\"never\">\n      <el-table\n        :data=\"tableData\"\n        stripe\n        border\n        highlight-current-row\n      >\n        <el-table-column prop=\"id\" label=\"序号\" width=\"70\" align=\"center\" sortable />\n        <el-table-column prop=\"goodsName\" label=\"商品名称\" min-width=\"160\" show-overflow-tooltip />\n        <el-table-column label=\"商品图片\" width=\"80\" align=\"center\">\n          <template #default=\"{ row }\">\n            <el-image\n              v-if=\"row.goodsImg\"\n              :src=\"row.goodsImg\"\n              :preview-src-list=\"[row.goodsImg]\"\n              style=\"width:50px\"\n            />\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"orderNo\" label=\"订单编号\" min-width=\"150\" show-overflow-tooltip />\n        <el-table-column prop=\"total\" label=\"总价\" width=\"90\">\n          <template #default=\"{ row }\">\n            <span class=\"price\">￥{{ row.total }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"time\" label=\"下单时间\" min-width=\"140\" show-overflow-tooltip />\n        <el-table-column prop=\"payNo\" label=\"支付单号\" min-width=\"140\" show-overflow-tooltip />\n        <el-table-column prop=\"payTime\" label=\"支付时间\" min-width=\"140\" show-overflow-tooltip />\n        <el-table-column prop=\"user\" label=\"下单人名称\" min-width=\"100\" show-overflow-tooltip />\n        <el-table-column prop=\"address\" label=\"收货地址\" min-width=\"150\" show-overflow-tooltip />\n        <el-table-column prop=\"phone\" label=\"联系方式\" width=\"110\" show-overflow-tooltip />\n        <el-table-column prop=\"userName\" label=\"收货人名称\" width=\"110\" />\n        <el-table-column prop=\"status\" label=\"订单状态\" width=\"100\" align=\"center\">\n          <template #default=\"{ row }\">\n            <el-tag\n              :type=\"statusTagType[row.status]\"\n              effect=\"plain\"\n              size=\"mini\"\n            >{{ row.status }}</el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"saleName\" label=\"卖家名称\" min-width=\"100\" />\n        <el-table-column label=\"操作\" width=\"260\" align=\"center\">\n          <template #default=\"{ row }\">\n            <el-button\n              v-if=\"row.status === '待支付'\"\n              size=\"mini\"\n              type=\"primary\"\n              plain\n              @click=\"pay(row.orderNo)\"\n            >支付</el-button>\n            <el-button\n              v-if=\"row.status === '待支付'\"\n              size=\"mini\"\n              type=\"danger\"\n              plain\n              @click=\"changeStatus(row, '已取消')\"\n            >取消</el-button>\n            <el-button\n              v-if=\"row.status === '待发货' && row.saleId === user.id\"\n              size=\"mini\"\n              type=\"info\"\n              plain\n              @click=\"changeStatus(row, '待收货')\"\n            >发货</el-button>\n            <el-button\n              v-if=\"row.status === '待收货' && row.userId === user.id\"\n              size=\"mini\"\n              type=\"primary\"\n              plain\n              @click=\"changeStatus(row, '已完成')\"\n            >收货</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <!-- ▍分页 -->\n      <el-pagination\n        class=\"pager\"\n        background\n        layout=\"total, prev, pager, next\"\n        :current-page=\"pageNum\"\n        :page-size=\"pageSize\"\n        :total=\"total\"\n        :page-sizes=\"[5, 10, 20]\"\n        @current-change=\"handleCurrentChange\"\n      />\n    </el-card>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'Orders',\n  data() {\n    return {\n      url: 'selectPage',\n      tableData: [],\n      pageNum: 1,\n      pageSize: 10,\n      total: 0,\n      goodsName: '',\n      orderNo: '',\n      status: '',\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      statusOptions: ['已取消', '待支付', '待发货', '待收货', '已完成'],\n      statusTagType: {\n        已取消: 'danger',\n        待支付: 'danger',\n        待发货: 'primary',\n        待收货: 'info',\n        已完成: 'success'\n      }\n    }\n  },\n  created() {\n    this.load()\n  },\n  methods: {\n    /* ---------- 支付 ---------- */\n    pay(orderNo) {\n      window.open(`http://localhost:9090/alipay/pay?orderNo=${orderNo}`)\n    },\n\n    /* ---------- 状态更新 ---------- */\n    changeStatus(row, nextStatus) {\n      this.$confirm('您确认操作吗？', '提示', { type: 'warning' })\n        .then(() => {\n          const payload = { ...row, status: nextStatus }\n          return this.$request.put('/orders/update', payload)\n        })\n        .then(({ code, msg }) => {\n          code === '200'\n            ? (this.$message.success('操作成功'), this.load(1))\n            : this.$message.error(msg)\n        })\n        .catch(() => {})\n    },\n\n    /* ---------- 列表查询 ---------- */\n    async load(page = this.pageNum) {\n      this.pageNum = page\n      const { code, data, msg } = await this.$request.get(`/orders/${this.url}`, {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize,\n          goodsName: this.goodsName,\n          status: this.status,\n          orderNo: this.orderNo\n        }\n      })\n      if (code === '200') {\n        this.tableData = data.list\n        this.total = data.total\n      } else {\n        this.$message.error(msg)\n      }\n    },\n\n    /* ---------- 辅助 ---------- */\n    reset() {\n      this.goodsName = this.orderNo = this.status = ''\n      this.load(1)\n    },\n    handleCurrentChange(page) {\n      this.load(page)\n    }\n  }\n}\n</script>\n\n<style scoped>\n.orders-page {\n  width: 85%;\n  margin: 20px auto;\n}\n/* 筛选栏 */\n.filter-bar {\n  display: flex;\n  align-items: center;\n  margin-bottom: 15px;\n}\n.filter-right {\n  margin-left: auto;\n  display: flex;\n  align-items: center;\n}\n.w200 {\n  width: 200px;\n}\n.mr5 {\n  margin-right: 5px;\n}\n/* 价格高亮 */\n.price {\n  color: #ff4d4f;\n}\n/* 分页 */\n.pager {\n  margin-top: 16px;\n  text-align: center;\n}\n</style>\n"],"mappings":"AAqIA;EACAA,IAAA;EACAC,KAAA;IACA;MACAC,GAAA;MACAC,SAAA;MACAC,OAAA;MACAC,QAAA;MACAC,KAAA;MACAC,SAAA;MACAC,OAAA;MACAC,MAAA;MACAC,IAAA,EAAAC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;MACAC,aAAA;MACAC,aAAA;QACAC,GAAA;QACAC,GAAA;QACAC,GAAA;QACAC,GAAA;QACAC,GAAA;MACA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,IAAA;EACA;EACAC,OAAA;IACA;IACAC,IAAAjB,OAAA;MACAkB,MAAA,CAAAC,IAAA,6CAAAnB,OAAA;IACA;IAEA;IACAoB,aAAAC,GAAA,EAAAC,UAAA;MACA,KAAAC,QAAA;QAAAC,IAAA;MAAA,GACAC,IAAA;QACA,MAAAC,OAAA;UAAA,GAAAL,GAAA;UAAApB,MAAA,EAAAqB;QAAA;QACA,YAAAK,QAAA,CAAAC,GAAA,mBAAAF,OAAA;MACA,GACAD,IAAA;QAAAI,IAAA;QAAAC;MAAA;QACAD,IAAA,cACA,KAAAE,QAAA,CAAAC,OAAA,eAAAjB,IAAA,OACA,KAAAgB,QAAA,CAAAE,KAAA,CAAAH,GAAA;MACA,GACAI,KAAA;IACA;IAEA;IACA,MAAAnB,KAAAoB,IAAA,QAAAvC,OAAA;MACA,KAAAA,OAAA,GAAAuC,IAAA;MACA;QAAAN,IAAA;QAAApC,IAAA;QAAAqC;MAAA,eAAAH,QAAA,CAAAS,GAAA,iBAAA1C,GAAA;QACA2C,MAAA;UACAzC,OAAA,OAAAA,OAAA;UACAC,QAAA,OAAAA,QAAA;UACAE,SAAA,OAAAA,SAAA;UACAE,MAAA,OAAAA,MAAA;UACAD,OAAA,OAAAA;QACA;MACA;MACA,IAAA6B,IAAA;QACA,KAAAlC,SAAA,GAAAF,IAAA,CAAA6C,IAAA;QACA,KAAAxC,KAAA,GAAAL,IAAA,CAAAK,KAAA;MACA;QACA,KAAAiC,QAAA,CAAAE,KAAA,CAAAH,GAAA;MACA;IACA;IAEA;IACAS,MAAA;MACA,KAAAxC,SAAA,QAAAC,OAAA,QAAAC,MAAA;MACA,KAAAc,IAAA;IACA;IACAyB,oBAAAL,IAAA;MACA,KAAApB,IAAA,CAAAoB,IAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}