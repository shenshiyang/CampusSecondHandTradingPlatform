{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  name: 'Profile',\n  data() {\n    const validateConfirm = (rule, value, cb) => value !== this.user.newPassword ? cb(new Error('两次输入不一致')) : cb();\n    return {\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      dialogVisible: false,\n      btnLoading: false,\n      pwdLoading: false,\n      rules: {\n        password: [{\n          required: true,\n          message: '请输入原始密码',\n          trigger: 'blur'\n        }],\n        newPassword: [{\n          required: true,\n          message: '请输入新密码',\n          trigger: 'blur'\n        }],\n        confirmPassword: [{\n          required: true,\n          validator: validateConfirm,\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  methods: {\n    /* 头像上传成功 */\n    handleAvatarSuccess({\n      data\n    }) {\n      this.user.avatar = data;\n      this.$message.success('上传成功');\n    },\n    /* 保存资料 */\n    async update() {\n      this.btnLoading = true;\n      const {\n        code,\n        msg\n      } = await this.$request.put('/user/update', this.user);\n      this.btnLoading = false;\n      if (code === '200') {\n        this.$message.success('保存成功');\n        localStorage.setItem('xm-user', JSON.stringify(this.user));\n        this.$emit('update:user');\n      } else {\n        this.$message.error(msg);\n      }\n    },\n    /* 保存密码 */\n    savePwd() {\n      this.$refs.formRef.validate(async valid => {\n        if (!valid) return;\n        this.pwdLoading = true;\n        const {\n          code,\n          msg\n        } = await this.$request.put('/updatePassword', this.user);\n        this.pwdLoading = false;\n        if (code === '200') {\n          this.$message.success('修改密码成功，请重新登录');\n          this.$router.push('/login');\n        } else {\n          this.$message.error(msg);\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["name","data","validateConfirm","rule","value","cb","user","newPassword","Error","JSON","parse","localStorage","getItem","dialogVisible","btnLoading","pwdLoading","rules","password","required","message","trigger","confirmPassword","validator","methods","handleAvatarSuccess","avatar","$message","success","update","code","msg","$request","put","setItem","stringify","$emit","error","savePwd","$refs","formRef","validate","valid","$router","push"],"sources":["src/views/front/Person.vue"],"sourcesContent":["<template>\n  <div class=\"profile-page\">\n    <el-card shadow=\"hover\" class=\"profile-card\">\n      <div class=\"card-header\">\n        <h2>个人资料</h2>\n        <p class=\"subtitle\">完善个人信息，让其他用户更了解你</p>\n      </div>\n      \n      <el-form\n        :model=\"user\"\n        label-width=\"80px\"\n        class=\"profile-form\"\n      >\n        <!-- 头像上传 -->\n        <div class=\"avatar-wrap\">\n          <el-upload\n            class=\"avatar-uploader\"\n            :action=\"$baseUrl + '/files/upload'\"\n            :show-file-list=\"false\"\n            :on-success=\"handleAvatarSuccess\"\n          >\n            <div class=\"avatar-container\">\n              <img v-if=\"user.avatar\" :src=\"user.avatar\" class=\"avatar\" />\n              <i v-else class=\"el-icon-plus avatar-placeholder\" />\n              <div class=\"avatar-hover\">\n                <i class=\"el-icon-camera\"></i>\n                <span>更换头像</span>\n              </div>\n            </div>\n          </el-upload>\n        </div>\n\n        <el-form-item label=\"用户名\">\n          <el-input \n            v-model=\"user.username\" \n            disabled\n            prefix-icon=\"el-icon-user\"\n          />\n        </el-form-item>\n\n        <el-form-item label=\"姓名\">\n          <el-input \n            v-model.trim=\"user.name\" \n            placeholder=\"请输入您的姓名\"\n            prefix-icon=\"el-icon-user-solid\"\n          />\n        </el-form-item>\n\n        <el-form-item label=\"电话\">\n          <el-input \n            v-model.trim=\"user.phone\" \n            placeholder=\"请输入您的联系电话\" \n            maxlength=\"11\"\n            prefix-icon=\"el-icon-phone\"\n          />\n        </el-form-item>\n\n        <el-form-item label=\"邮箱\">\n          <el-input \n            v-model.trim=\"user.email\" \n            placeholder=\"请输入您的邮箱地址\"\n            prefix-icon=\"el-icon-message\"\n          />\n        </el-form-item>\n\n        <div class=\"actions\">\n          <el-button\n            type=\"primary\"\n            :loading=\"btnLoading\"\n            @click=\"update\"\n            icon=\"el-icon-check\"\n          >保存修改</el-button>\n          <el-button\n            type=\"warning\"\n            @click=\"dialogVisible = true\"\n            icon=\"el-icon-key\"\n          >修改密码</el-button>\n        </div>\n      </el-form>\n    </el-card>\n\n    <!-- 修改密码弹窗 -->\n    <el-dialog\n      title=\"修改密码\"\n      :visible.sync=\"dialogVisible\"\n      width=\"400px\"\n      :close-on-click-modal=\"false\"\n      destroy-on-close\n      custom-class=\"password-dialog\"\n    >\n      <el-form\n        ref=\"formRef\"\n        :model=\"user\"\n        :rules=\"rules\"\n        label-width=\"90px\"\n      >\n        <el-form-item label=\"原始密码\" prop=\"password\">\n          <el-input \n            show-password \n            v-model.trim=\"user.password\"\n            prefix-icon=\"el-icon-lock\"\n            placeholder=\"请输入原始密码\"\n          />\n        </el-form-item>\n        <el-form-item label=\"新密码\" prop=\"newPassword\">\n          <el-input \n            show-password \n            v-model.trim=\"user.newPassword\"\n            prefix-icon=\"el-icon-key\"\n            placeholder=\"请输入新密码\"\n          />\n        </el-form-item>\n        <el-form-item label=\"确认密码\" prop=\"confirmPassword\">\n          <el-input \n            show-password \n            v-model.trim=\"user.confirmPassword\"\n            prefix-icon=\"el-icon-key\"\n            placeholder=\"请再次输入新密码\"\n          />\n        </el-form-item>\n      </el-form>\n\n      <template #footer>\n        <el-button \n          @click=\"dialogVisible = false\"\n          icon=\"el-icon-close\"\n        >取消</el-button>\n        <el-button\n          type=\"primary\"\n          :loading=\"pwdLoading\"\n          @click=\"savePwd\"\n          icon=\"el-icon-check\"\n        >确认修改</el-button>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'Profile',\n  data() {\n    const validateConfirm = (rule, value, cb) =>\n      value !== this.user.newPassword\n        ? cb(new Error('两次输入不一致'))\n        : cb()\n\n    return {\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      dialogVisible: false,\n      btnLoading: false,\n      pwdLoading: false,\n      rules: {\n        password: [{ required: true, message: '请输入原始密码', trigger: 'blur' }],\n        newPassword: [{ required: true, message: '请输入新密码', trigger: 'blur' }],\n        confirmPassword: [\n          { required: true, validator: validateConfirm, trigger: 'blur' }\n        ]\n      }\n    }\n  },\n  methods: {\n    /* 头像上传成功 */\n    handleAvatarSuccess({ data }) {\n      this.user.avatar = data\n      this.$message.success('上传成功')\n    },\n\n    /* 保存资料 */\n    async update() {\n      this.btnLoading = true\n      const { code, msg } = await this.$request.put('/user/update', this.user)\n      this.btnLoading = false\n      if (code === '200') {\n        this.$message.success('保存成功')\n        localStorage.setItem('xm-user', JSON.stringify(this.user))\n        this.$emit('update:user')\n      } else {\n        this.$message.error(msg)\n      }\n    },\n\n    /* 保存密码 */\n    savePwd() {\n      this.$refs.formRef.validate(async (valid) => {\n        if (!valid) return\n        this.pwdLoading = true\n        const { code, msg } = await this.$request.put('/updatePassword', this.user)\n        this.pwdLoading = false\n        if (code === '200') {\n          this.$message.success('修改密码成功，请重新登录')\n          this.$router.push('/login')\n        } else {\n          this.$message.error(msg)\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.profile-page {\n  width: 60%;\n  max-width: 800px;\n  margin: 30px auto;\n}\n\n.profile-card {\n  border-radius: 8px;\n  padding: 0;\n}\n\n.card-header {\n  background: linear-gradient(135deg, #409EFF 0%, #66b1ff 100%);\n  color: white;\n  padding: 20px 40px;\n  border-radius: 8px 8px 0 0;\n  margin-bottom: 30px;\n}\n\n.card-header h2 {\n  margin: 0;\n  font-size: 24px;\n  font-weight: 500;\n}\n\n.subtitle {\n  margin: 8px 0 0;\n  font-size: 14px;\n  opacity: 0.9;\n}\n\n.profile-form {\n  padding: 0 40px 30px;\n}\n\n.profile-form :deep(.el-form-item__label) {\n  font-weight: 500;\n  color: #606266;\n}\n\n.profile-form :deep(.el-input__inner) {\n  border-radius: 4px;\n}\n\n.profile-form :deep(.el-input__inner:focus) {\n  border-color: #409EFF;\n}\n\n.avatar-wrap {\n  text-align: center;\n  margin-bottom: 30px;\n}\n\n.avatar-container {\n  position: relative;\n  display: inline-block;\n  border-radius: 50%;\n  overflow: hidden;\n}\n\n.avatar-uploader .el-upload {\n  border: 2px dashed #e0e0e0;\n  border-radius: 50%;\n  cursor: pointer;\n  transition: all 0.3s;\n}\n\n.avatar-uploader:hover .el-upload {\n  border-color: #409EFF;\n}\n\n.avatar-placeholder {\n  font-size: 32px;\n  color: #909399;\n  width: 120px;\n  height: 120px;\n  line-height: 120px;\n  text-align: center;\n  border-radius: 50%;\n  background: #f5f7fa;\n}\n\n.avatar {\n  width: 120px;\n  height: 120px;\n  border-radius: 50%;\n  display: block;\n  object-fit: cover;\n}\n\n.avatar-hover {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  color: white;\n  opacity: 0;\n  transition: all 0.3s;\n}\n\n.avatar-container:hover .avatar-hover {\n  opacity: 1;\n}\n\n.avatar-hover i {\n  font-size: 24px;\n  margin-bottom: 8px;\n}\n\n.avatar-hover span {\n  font-size: 14px;\n}\n\n.actions {\n  text-align: center;\n  margin-top: 30px;\n}\n\n.actions .el-button {\n  padding: 12px 30px;\n  font-size: 14px;\n  border-radius: 4px;\n  transition: all 0.3s;\n}\n\n.actions .el-button + .el-button {\n  margin-left: 20px;\n}\n\n:deep(.password-dialog) {\n  border-radius: 8px;\n}\n\n:deep(.password-dialog .el-dialog__header) {\n  padding: 20px;\n  background: #f5f7fa;\n  border-radius: 8px 8px 0 0;\n}\n\n:deep(.password-dialog .el-dialog__title) {\n  font-size: 18px;\n  font-weight: 500;\n  color: #303133;\n}\n\n:deep(.password-dialog .el-dialog__body) {\n  padding: 30px 20px;\n}\n\n:deep(.password-dialog .el-dialog__footer) {\n  padding: 10px 20px 20px;\n  border-top: 1px solid #f0f0f0;\n}\n\n:deep(.el-button--primary) {\n  background: linear-gradient(135deg, #409EFF 0%, #66b1ff 100%);\n  border: none;\n}\n\n:deep(.el-button--primary:hover) {\n  background: linear-gradient(135deg, #66b1ff 0%, #409EFF 100%);\n  transform: translateY(-1px);\n}\n\n:deep(.el-button--warning) {\n  background: linear-gradient(135deg, #e6a23c 0%, #f3d19e 100%);\n  border: none;\n  color: white;\n}\n\n:deep(.el-button--warning:hover) {\n  background: linear-gradient(135deg, #f3d19e 0%, #e6a23c 100%);\n  transform: translateY(-1px);\n}\n</style>\n"],"mappings":";AA2IA;EACAA,IAAA;EACAC,KAAA;IACA,MAAAC,eAAA,GAAAA,CAAAC,IAAA,EAAAC,KAAA,EAAAC,EAAA,KACAD,KAAA,UAAAE,IAAA,CAAAC,WAAA,GACAF,EAAA,KAAAG,KAAA,eACAH,EAAA;IAEA;MACAC,IAAA,EAAAG,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;MACAC,aAAA;MACAC,UAAA;MACAC,UAAA;MACAC,KAAA;QACAC,QAAA;UAAAC,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;QACAb,WAAA;UAAAW,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;QACAC,eAAA,GACA;UAAAH,QAAA;UAAAI,SAAA,EAAApB,eAAA;UAAAkB,OAAA;QAAA;MAEA;IACA;EACA;EACAG,OAAA;IACA;IACAC,oBAAA;MAAAvB;IAAA;MACA,KAAAK,IAAA,CAAAmB,MAAA,GAAAxB,IAAA;MACA,KAAAyB,QAAA,CAAAC,OAAA;IACA;IAEA;IACA,MAAAC,OAAA;MACA,KAAAd,UAAA;MACA;QAAAe,IAAA;QAAAC;MAAA,eAAAC,QAAA,CAAAC,GAAA,sBAAA1B,IAAA;MACA,KAAAQ,UAAA;MACA,IAAAe,IAAA;QACA,KAAAH,QAAA,CAAAC,OAAA;QACAhB,YAAA,CAAAsB,OAAA,YAAAxB,IAAA,CAAAyB,SAAA,MAAA5B,IAAA;QACA,KAAA6B,KAAA;MACA;QACA,KAAAT,QAAA,CAAAU,KAAA,CAAAN,GAAA;MACA;IACA;IAEA;IACAO,QAAA;MACA,KAAAC,KAAA,CAAAC,OAAA,CAAAC,QAAA,OAAAC,KAAA;QACA,KAAAA,KAAA;QACA,KAAA1B,UAAA;QACA;UAAAc,IAAA;UAAAC;QAAA,eAAAC,QAAA,CAAAC,GAAA,yBAAA1B,IAAA;QACA,KAAAS,UAAA;QACA,IAAAc,IAAA;UACA,KAAAH,QAAA,CAAAC,OAAA;UACA,KAAAe,OAAA,CAAAC,IAAA;QACA;UACA,KAAAjB,QAAA,CAAAU,KAAA,CAAAN,GAAA;QACA;MACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}