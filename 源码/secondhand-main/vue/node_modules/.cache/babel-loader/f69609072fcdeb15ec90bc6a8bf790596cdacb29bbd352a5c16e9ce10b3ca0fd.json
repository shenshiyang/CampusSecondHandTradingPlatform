{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport Comment from \"@/components/Comment\";\nexport default {\n  name: \"GoodsDetail\",\n  components: {\n    Comment\n  },\n  data() {\n    return {\n      id: this.$route.query.id,\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      goods: {},\n      current: '商品详情',\n      form: {},\n      fromVisible: false,\n      addressList: []\n    };\n  },\n  created() {\n    this.$request.put('/goods/updateReadCount/' + this.id).then(() => {\n      this.load();\n    });\n    this.loadAddress();\n  },\n  methods: {\n    chat(userId) {\n      this.$request.post('/chatGroup/add', {\n        chatUserId: userId,\n        userId: this.user.id\n      }).then(() => {\n        this.$router.push('/front/chat');\n      });\n    },\n    handleBuy() {\n      this.form = {};\n      this.fromVisible = true;\n    },\n    addOrder() {\n      if (!this.form.addressId) {\n        this.$message.warning('请选择收货地址');\n        return;\n      }\n      this.form.goodsId = this.id;\n      this.$request.post('/orders/add', this.form).then(res => {\n        if (res.code === '200') {\n          this.$message.success('下单成功');\n          this.$router.push('/front/orders');\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    loadAddress() {\n      this.$request.get('/address/selectAll').then(res => {\n        this.addressList = res.data || [];\n      });\n    },\n    addLikes() {\n      const isLiking = !this.goods.userLikes;\n      const messageText = isLiking ? '点赞成功' : '取消点赞成功';\n      this.$request.post('/likes/add', {\n        userId: this.user.id,\n        fid: this.goods.id,\n        module: 'goods'\n      }).then(res => {\n        if (res.code === '200') {\n          this.$message.success(messageText);\n          this.load();\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    addCollect() {\n      const isCollecting = !this.goods.userCollect;\n      const messageText = isCollecting ? '收藏成功' : '取消收藏成功';\n      this.$request.post('/collect/add', {\n        userId: this.user.id,\n        fid: this.goods.id,\n        module: 'goods',\n        goodsName: this.goods.name,\n        goodsImg: this.goods.img\n      }).then(res => {\n        if (res.code === '200') {\n          this.$message.success(messageText);\n          this.load();\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    changeItem(current) {\n      this.current = current;\n    },\n    load() {\n      this.$request.get('/goods/selectById/' + this.id).then(res => {\n        this.goods = res.data || {};\n      });\n    }\n  }\n};","map":{"version":3,"names":["Comment","name","components","data","id","$route","query","user","JSON","parse","localStorage","getItem","goods","current","form","fromVisible","addressList","created","$request","put","then","load","loadAddress","methods","chat","userId","post","chatUserId","$router","push","handleBuy","addOrder","addressId","$message","warning","goodsId","res","code","success","error","msg","get","addLikes","isLiking","userLikes","messageText","fid","module","addCollect","isCollecting","userCollect","goodsName","goodsImg","img","changeItem"],"sources":["src/views/front/GoodsDetail.vue"],"sourcesContent":["<template>\n  <div style=\"margin: 0 auto; padding: 10px 0; width: 50%\">\n    <div style=\"display: flex; grid-gap: 20px; margin-bottom: 40px\">\n      <!-- 商品图片 -->\n      <img :src=\"goods.img\" alt=\"\" style=\"width: 50%; height: 400px; display: block\">\n\n      <!-- 商品信息 -->\n      <div style=\"flex: 1; width: 0\">\n        <div class=\"goods-info\">\n          <div class=\"goods-title\">{{ goods.name }}</div>\n\n          <div class=\"meta-info\">\n            <span><i class=\"el-icon-view\"></i> 浏览 {{ goods.readCount }}</span>\n            <span><i class=\"el-icon-thumb\"></i> 点赞 {{ goods.likesCount }}</span>\n            <span><i class=\"el-icon-star-off\"></i> 收藏 {{ goods.collectCount }}</span>\n          </div>\n\n          <div class=\"goods-price\">￥{{ goods.price }}</div>\n\n          <div class=\"detail-line\"><span>发货地：</span>{{ goods.address }}</div>\n\n          <div class=\"detail-line seller-line\">\n            <span>卖家：</span>\n            <img :src=\"goods.userAvatar\" class=\"avatar\" />\n            <span>{{ goods.userName }}</span>\n            <i @click=\"chat(goods.userId)\" class=\"el-icon-chat-dot-round chat-icon\"></i>\n          </div>\n\n          <div class=\"detail-line\"><span>发布日期：</span>{{ goods.date }}</div>\n        </div>\n\n        <!-- 按钮一行排布 -->\n        <div class=\"button-group\">\n          <el-button v-if=\"!goods.userLikes\" @click=\"addLikes\" class=\"like-button\">👍 点赞</el-button>\n          <el-button v-if=\"goods.userLikes\" @click=\"addLikes\" class=\"like-button liked\">✅ 已点赞</el-button>\n\n          <el-button v-if=\"!goods.userCollect\" @click=\"addCollect\" class=\"collect-button\">❤️ 收藏</el-button>\n          <el-button v-if=\"goods.userCollect\" @click=\"addCollect\" class=\"collect-button collected\">💔 已收藏</el-button>\n\n          <el-button class=\"chat-button\" @click=\"chat(goods.userId)\">💬 联系卖家</el-button>\n          <el-button class=\"buy-button\" @click=\"handleBuy\">立即购买</el-button>\n        </div>\n      </div>\n    </div>\n\n    <!-- 商品详情/评论切换 -->\n    <div>\n      <div style=\"display: flex; border-bottom: 1px solid orangered; margin-bottom: 10px\">\n        <div style=\"padding: 10px 20px; cursor: pointer\" :class=\"{ 'active' : current === '商品详情' }\" @click=\"changeItem('商品详情')\">商品详情</div>\n        <div style=\"padding: 10px 20px; cursor: pointer\" :class=\"{ 'active' : current === '商品评论' }\" @click=\"changeItem('商品评论')\">商品评论</div>\n      </div>\n\n      <div v-if=\"current === '商品详情'\">\n        <div v-html=\"goods.content\"></div>\n      </div>\n\n      <div v-if=\"current === '商品评论'\" class=\"card\">\n        <Comment :fid=\"id\" module=\"goods\" />\n      </div>\n\n      <!-- 下单弹窗 -->\n      <el-dialog title=\"选择收货地址\" :visible.sync=\"fromVisible\" width=\"30%\" :close-on-click-modal=\"false\" destroy-on-close>\n        <div style=\"padding: 0 20px\">\n          <el-radio-group v-model=\"form.addressId\">\n            <el-radio v-for=\"item in addressList\" :key=\"item.id\" :label=\"item.id\" style=\"margin-bottom: 10px\">\n              {{ item.name + ' ' + item.address + ' ' + item.phone }}\n            </el-radio>\n          </el-radio-group>\n          <a v-if=\"addressList.length === 0\" href=\"/front/address\" target=\"_blank\">还没有收货地址？去创建</a>\n        </div>\n        <div slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click=\"fromVisible = false\">取 消</el-button>\n          <el-button type=\"primary\" @click=\"addOrder\">确 定</el-button>\n        </div>\n      </el-dialog>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Comment from \"@/components/Comment\";\nexport default {\n  name: \"GoodsDetail\",\n  components: { Comment },\n  data() {\n    return {\n      id: this.$route.query.id,\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      goods: {},\n      current: '商品详情',\n      form: {},\n      fromVisible: false,\n      addressList: []\n    }\n  },\n  created() {\n    this.$request.put('/goods/updateReadCount/' + this.id).then(() => {\n      this.load()\n    })\n    this.loadAddress()\n  },\n  methods: {\n    chat(userId) {\n      this.$request.post('/chatGroup/add', { chatUserId: userId, userId: this.user.id }).then(() => {\n        this.$router.push('/front/chat')\n      })\n    },\n    handleBuy() {\n      this.form = {}\n      this.fromVisible = true\n    },\n    addOrder() {\n      if (!this.form.addressId) {\n        this.$message.warning('请选择收货地址')\n        return\n      }\n      this.form.goodsId = this.id\n      this.$request.post('/orders/add', this.form).then(res => {\n        if (res.code === '200') {\n          this.$message.success('下单成功')\n          this.$router.push('/front/orders')\n        } else {\n          this.$message.error(res.msg)\n        }\n      })\n    },\n    loadAddress() {\n      this.$request.get('/address/selectAll').then(res => {\n        this.addressList = res.data || []\n      })\n    },\n    addLikes() {\n      const isLiking = !this.goods.userLikes\n      const messageText = isLiking ? '点赞成功' : '取消点赞成功'\n      this.$request.post('/likes/add', {\n        userId: this.user.id,\n        fid: this.goods.id,\n        module: 'goods'\n      }).then(res => {\n        if (res.code === '200') {\n          this.$message.success(messageText)\n          this.load()\n        } else {\n          this.$message.error(res.msg)\n        }\n      })\n    },\n    addCollect() {\n      const isCollecting = !this.goods.userCollect\n      const messageText = isCollecting ? '收藏成功' : '取消收藏成功'\n      this.$request.post('/collect/add', {\n        userId: this.user.id,\n        fid: this.goods.id,\n        module: 'goods',\n        goodsName: this.goods.name,\n        goodsImg: this.goods.img\n      }).then(res => {\n        if (res.code === '200') {\n          this.$message.success(messageText)\n          this.load()\n        } else {\n          this.$message.error(res.msg)\n        }\n      })\n    },\n    changeItem(current) {\n      this.current = current\n    },\n    load() {\n      this.$request.get('/goods/selectById/' + this.id).then(res => {\n        this.goods = res.data || {}\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.active {\n  background-color: orangered;\n  color: #eee;\n}\n\n/* 右侧信息区域样式 */\n.goods-info {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n.goods-title {\n  font-size: 28px;\n  font-weight: 600;\n  color: #333;\n  margin-bottom: 5px;\n}\n.meta-info {\n  display: flex;\n  gap: 20px;\n  font-size: 14px;\n  color: #888;\n  align-items: center;\n}\n.meta-info i {\n  margin-right: 4px;\n  color: #999;\n}\n.goods-price {\n  font-size: 26px;\n  color: #ff3c3c;\n  font-weight: bold;\n  margin: 10px 0;\n}\n.detail-line {\n  font-size: 15px;\n  color: #444;\n}\n.detail-line span {\n  font-weight: 500;\n  color: #888;\n  margin-right: 4px;\n}\n.seller-line {\n  display: flex;\n  align-items: center;\n}\n.avatar {\n  width: 26px;\n  height: 26px;\n  border-radius: 50%;\n  margin: 0 6px;\n  object-fit: cover;\n  border: 1px solid #eee;\n}\n.chat-icon {\n  font-size: 16px;\n  margin-left: 6px;\n  color: #409EFF;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n.chat-icon:hover {\n  transform: scale(1.2);\n}\n\n/* 按钮组样式 */\n.button-group {\n  display: flex;\n  flex-wrap: nowrap;\n  gap: 12px;\n  align-items: center;\n  margin-top: 30px;\n}\n.el-button {\n  min-width: 100px;\n  height: 40px;\n  font-weight: bold;\n  transition: all 0.3s ease;\n  white-space: nowrap;\n}\n.like-button {\n  background-color: #ff7f50;\n  color: #fff;\n  border: none;\n}\n.like-button:hover {\n  background-color: #ff4500;\n  transform: scale(1.05);\n}\n.liked {\n  background-color: #aaa !important;\n  color: #fff;\n}\n.collect-button {\n  background-color: #f6c344;\n  color: #fff;\n  border: none;\n}\n.collect-button:hover {\n  background-color: #e8a600;\n  transform: scale(1.05);\n}\n.collected {\n  background-color: #888 !important;\n  color: #fff;\n}\n.chat-button {\n  border: 1px solid #409EFF;\n  color: #409EFF;\n  background-color: #fff;\n}\n.chat-button:hover {\n  background-color: #409EFF;\n  color: #fff;\n  transform: scale(1.05);\n}\n.buy-button {\n  background-color: #ff0055;\n  color: #fff;\n  border: none;\n}\n.buy-button:hover {\n  background-color: #e6004c;\n  transform: scale(1.05);\n}\n</style>\n"],"mappings":";AAgFA,OAAAA,OAAA;AACA;EACAC,IAAA;EACAC,UAAA;IAAAF;EAAA;EACAG,KAAA;IACA;MACAC,EAAA,OAAAC,MAAA,CAAAC,KAAA,CAAAF,EAAA;MACAG,IAAA,EAAAC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;MACAC,KAAA;MACAC,OAAA;MACAC,IAAA;MACAC,WAAA;MACAC,WAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,QAAA,CAAAC,GAAA,kCAAAf,EAAA,EAAAgB,IAAA;MACA,KAAAC,IAAA;IACA;IACA,KAAAC,WAAA;EACA;EACAC,OAAA;IACAC,KAAAC,MAAA;MACA,KAAAP,QAAA,CAAAQ,IAAA;QAAAC,UAAA,EAAAF,MAAA;QAAAA,MAAA,OAAAlB,IAAA,CAAAH;MAAA,GAAAgB,IAAA;QACA,KAAAQ,OAAA,CAAAC,IAAA;MACA;IACA;IACAC,UAAA;MACA,KAAAhB,IAAA;MACA,KAAAC,WAAA;IACA;IACAgB,SAAA;MACA,UAAAjB,IAAA,CAAAkB,SAAA;QACA,KAAAC,QAAA,CAAAC,OAAA;QACA;MACA;MACA,KAAApB,IAAA,CAAAqB,OAAA,QAAA/B,EAAA;MACA,KAAAc,QAAA,CAAAQ,IAAA,qBAAAZ,IAAA,EAAAM,IAAA,CAAAgB,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAJ,QAAA,CAAAK,OAAA;UACA,KAAAV,OAAA,CAAAC,IAAA;QACA;UACA,KAAAI,QAAA,CAAAM,KAAA,CAAAH,GAAA,CAAAI,GAAA;QACA;MACA;IACA;IACAlB,YAAA;MACA,KAAAJ,QAAA,CAAAuB,GAAA,uBAAArB,IAAA,CAAAgB,GAAA;QACA,KAAApB,WAAA,GAAAoB,GAAA,CAAAjC,IAAA;MACA;IACA;IACAuC,SAAA;MACA,MAAAC,QAAA,SAAA/B,KAAA,CAAAgC,SAAA;MACA,MAAAC,WAAA,GAAAF,QAAA;MACA,KAAAzB,QAAA,CAAAQ,IAAA;QACAD,MAAA,OAAAlB,IAAA,CAAAH,EAAA;QACA0C,GAAA,OAAAlC,KAAA,CAAAR,EAAA;QACA2C,MAAA;MACA,GAAA3B,IAAA,CAAAgB,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAJ,QAAA,CAAAK,OAAA,CAAAO,WAAA;UACA,KAAAxB,IAAA;QACA;UACA,KAAAY,QAAA,CAAAM,KAAA,CAAAH,GAAA,CAAAI,GAAA;QACA;MACA;IACA;IACAQ,WAAA;MACA,MAAAC,YAAA,SAAArC,KAAA,CAAAsC,WAAA;MACA,MAAAL,WAAA,GAAAI,YAAA;MACA,KAAA/B,QAAA,CAAAQ,IAAA;QACAD,MAAA,OAAAlB,IAAA,CAAAH,EAAA;QACA0C,GAAA,OAAAlC,KAAA,CAAAR,EAAA;QACA2C,MAAA;QACAI,SAAA,OAAAvC,KAAA,CAAAX,IAAA;QACAmD,QAAA,OAAAxC,KAAA,CAAAyC;MACA,GAAAjC,IAAA,CAAAgB,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAJ,QAAA,CAAAK,OAAA,CAAAO,WAAA;UACA,KAAAxB,IAAA;QACA;UACA,KAAAY,QAAA,CAAAM,KAAA,CAAAH,GAAA,CAAAI,GAAA;QACA;MACA;IACA;IACAc,WAAAzC,OAAA;MACA,KAAAA,OAAA,GAAAA,OAAA;IACA;IACAQ,KAAA;MACA,KAAAH,QAAA,CAAAuB,GAAA,6BAAArC,EAAA,EAAAgB,IAAA,CAAAgB,GAAA;QACA,KAAAxB,KAAA,GAAAwB,GAAA,CAAAjC,IAAA;MACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}