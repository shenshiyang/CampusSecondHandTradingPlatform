{"ast":null,"code":"export default {\n  name: 'Posts',\n  data() {\n    return {\n      circles: [],\n      circle: '全部',\n      tableData: [],\n      total: 0,\n      pageNum: 1,\n      pageSize: 4,\n      loading: false\n    };\n  },\n  created() {\n    this.fetchCircles();\n    this.load();\n  },\n  methods: {\n    /* 读取圈子 */\n    async fetchCircles() {\n      const {\n        data\n      } = await this.$request.get('/circles/selectAll');\n      this.circles = data || [];\n    },\n    /* 点击圈子 */\n    loadCircle(name) {\n      if (this.circle === name) return; // 避免重复请求\n      this.circle = name;\n      this.load(1);\n    },\n    /* 读取帖子 */\n    async load(page = this.pageNum) {\n      this.pageNum = page;\n      this.loading = true;\n      const {\n        code,\n        data,\n        msg\n      } = await this.$request.get('/posts/selectFrontPage', {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize,\n          circle: this.circle === '全部' ? null : this.circle\n        }\n      });\n      this.loading = false;\n      if (code === '200') {\n        this.tableData = data.list;\n        this.total = data.total;\n      } else {\n        this.$message.error(msg);\n      }\n    },\n    /* 分页切换 */\n    handleCurrentChange(page) {\n      this.load(page);\n    }\n  }\n};","map":{"version":3,"names":["name","data","circles","circle","tableData","total","pageNum","pageSize","loading","created","fetchCircles","load","methods","$request","get","loadCircle","page","code","msg","params","list","$message","error","handleCurrentChange"],"sources":["src/views/front/Posts.vue"],"sourcesContent":["<template>\n  <div class=\"posts-page\">\n    <!-- ▍圈子筛选 -->\n    <section class=\"circle-wrap\">\n      <!-- 「全部」 -->\n      <div\n        class=\"circle-card\"\n        :class=\"{ active: circle === '全部' }\"\n        @click=\"loadCircle('全部')\"\n      >\n        <img src=\"@/assets/imgs/全部.png\" />\n        <span>全部</span>\n      </div>\n\n      <!-- 其余圈子 -->\n      <div\n        v-for=\"c in circles\"\n        :key=\"c.id\"\n        class=\"circle-card\"\n        :class=\"{ active: circle === c.name }\"\n        @click=\"loadCircle(c.name)\"\n      >\n        <img :src=\"c.img\" />\n        <span>{{ c.name }}</span>\n      </div>\n    </section>\n\n    <!-- ▍帖子列表 / 骨架屏  —— 保证 v-if / v-else 相邻 -->\n    <section>\n      <template v-if=\"loading\">\n        <el-skeleton :rows=\"5\" animated />\n      </template>\n\n      <template v-else>\n        <el-card\n          v-for=\"p in tableData\"\n          :key=\"p.id\"\n          class=\"post-card\"\n          shadow=\"hover\"\n          @click.native=\"$router.push(`/front/postsDetail?id=${p.id}`)\"\n        >\n          <div class=\"post-main\">\n            <!-- 文字区 -->\n            <div class=\"post-body\">\n              <h3 class=\"post-title\">{{ p.title }}</h3>\n              <p class=\"post-descr\">{{ p.descr }}</p>\n              <div class=\"post-meta\">\n                <span><i class=\"el-icon-user\" /> {{ p.userName }}</span>\n                <span><i class=\"el-icon-time\" /> {{ p.time }}</span>\n                <span><i class=\"el-icon-reading\" /> {{ p.readCount }}</span>\n              </div>\n            </div>\n\n            <!-- 缩略图 -->\n            <el-image\n              v-if=\"p.img\"\n              :src=\"p.img\"\n              :preview-src-list=\"[p.img]\"\n              class=\"post-img\"\n              fit=\"cover\"\n            />\n          </div>\n        </el-card>\n\n        <!-- 分页 -->\n        <el-pagination\n          v-if=\"total\"\n          class=\"pager\"\n          background\n          layout=\"total, prev, pager, next\"\n          :current-page=\"pageNum\"\n          :page-size=\"pageSize\"\n          :total=\"total\"\n          :page-sizes=\"[4, 8, 12]\"\n          @current-change=\"handleCurrentChange\"\n        />\n      </template>\n    </section>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'Posts',\n  data() {\n    return {\n      circles: [],\n      circle: '全部',\n      tableData: [],\n      total: 0,\n      pageNum: 1,\n      pageSize: 4,\n      loading: false\n    }\n  },\n  created() {\n    this.fetchCircles()\n    this.load()\n  },\n  methods: {\n    /* 读取圈子 */\n    async fetchCircles() {\n      const { data } = await this.$request.get('/circles/selectAll')\n      this.circles = data || []\n    },\n\n    /* 点击圈子 */\n    loadCircle(name) {\n      if (this.circle === name) return // 避免重复请求\n      this.circle = name\n      this.load(1)\n    },\n\n    /* 读取帖子 */\n    async load(page = this.pageNum) {\n      this.pageNum = page\n      this.loading = true\n      const { code, data, msg } = await this.$request.get('/posts/selectFrontPage', {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize,\n          circle: this.circle === '全部' ? null : this.circle\n        }\n      })\n      this.loading = false\n      if (code === '200') {\n        this.tableData = data.list\n        this.total = data.total\n      } else {\n        this.$message.error(msg)\n      }\n    },\n\n    /* 分页切换 */\n    handleCurrentChange(page) {\n      this.load(page)\n    }\n  }\n}\n</script>\n\n<style scoped>\n.posts-page {\n  width: 60%;\n  margin: 20px auto;\n}\n\n/* 圈子 */\n.circle-wrap {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 10px;\n  margin-bottom: 20px;\n}\n.circle-card {\n  display: flex;\n  align-items: center;\n  padding: 8px 12px;\n  border-radius: 4px;\n  cursor: pointer;\n  transition: background 0.2s;\n}\n.circle-card img {\n  width: 46px;\n  height: 46px;\n  margin-right: 6px;\n}\n.circle-card:hover,\n.circle-card.active {\n  background: #ffedd8;\n}\n\n/* 帖子卡片 */\n.post-card {\n  margin-bottom: 14px;\n  cursor: pointer;\n}\n.post-main {\n  display: flex;\n  gap: 10px;\n}\n.post-body {\n  flex: 1;\n}\n.post-title {\n  font-size: 18px;\n  margin-bottom: 6px;\n}\n.post-descr {\n  color: #666;\n  margin-bottom: 8px;\n}\n.post-meta {\n  color: #909399;\n  font-size: 13px;\n  display: flex;\n  gap: 18px;\n}\n.post-img {\n  width: 90px;\n  height: 90px;\n  border-radius: 4px;\n}\n\n/* 分页 */\n.pager {\n  margin-top: 22px;\n  text-align: center;\n}\n</style>\n"],"mappings":"AAkFA;EACAA,IAAA;EACAC,KAAA;IACA;MACAC,OAAA;MACAC,MAAA;MACAC,SAAA;MACAC,KAAA;MACAC,OAAA;MACAC,QAAA;MACAC,OAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,YAAA;IACA,KAAAC,IAAA;EACA;EACAC,OAAA;IACA;IACA,MAAAF,aAAA;MACA;QAAAT;MAAA,eAAAY,QAAA,CAAAC,GAAA;MACA,KAAAZ,OAAA,GAAAD,IAAA;IACA;IAEA;IACAc,WAAAf,IAAA;MACA,SAAAG,MAAA,KAAAH,IAAA;MACA,KAAAG,MAAA,GAAAH,IAAA;MACA,KAAAW,IAAA;IACA;IAEA;IACA,MAAAA,KAAAK,IAAA,QAAAV,OAAA;MACA,KAAAA,OAAA,GAAAU,IAAA;MACA,KAAAR,OAAA;MACA;QAAAS,IAAA;QAAAhB,IAAA;QAAAiB;MAAA,eAAAL,QAAA,CAAAC,GAAA;QACAK,MAAA;UACAb,OAAA,OAAAA,OAAA;UACAC,QAAA,OAAAA,QAAA;UACAJ,MAAA,OAAAA,MAAA,wBAAAA;QACA;MACA;MACA,KAAAK,OAAA;MACA,IAAAS,IAAA;QACA,KAAAb,SAAA,GAAAH,IAAA,CAAAmB,IAAA;QACA,KAAAf,KAAA,GAAAJ,IAAA,CAAAI,KAAA;MACA;QACA,KAAAgB,QAAA,CAAAC,KAAA,CAAAJ,GAAA;MACA;IACA;IAEA;IACAK,oBAAAP,IAAA;MACA,KAAAL,IAAA,CAAAK,IAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}