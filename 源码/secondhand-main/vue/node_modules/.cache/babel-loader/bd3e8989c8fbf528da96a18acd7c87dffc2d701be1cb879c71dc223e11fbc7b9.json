{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  name: \"FrontGoods\",\n  data() {\n    return {\n      tableData: [],\n      pageNum: 1,\n      pageSize: 10,\n      total: 0,\n      name: null,\n      content: '',\n      fromVisible1: false,\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}')\n    };\n  },\n  created() {\n    this.load(1);\n  },\n  methods: {\n    preview(content) {\n      this.content = content;\n      this.fromVisible1 = true;\n    },\n    handleEdit(row) {\n      this.$router.push('/front/addGoods?id=' + row.id);\n    },\n    del(id) {\n      this.$confirm('您确定删除吗？', '确认删除', {\n        type: \"warning\"\n      }).then(() => {\n        this.$request.delete('/goods/delete/' + id).then(res => {\n          if (res.code === '200') {\n            this.$message.success('操作成功');\n            this.load(1);\n          } else {\n            this.$message.error(res.msg);\n          }\n        });\n      }).catch(() => {});\n    },\n    updateStock(row) {\n      this.$request.post('/goods/updateStockAndSaleStatus', {\n        id: row.id,\n        stock: row.stock,\n        saleStatus: row.saleStatus\n      }).then(res => {\n        if (res.code === '200') {\n          this.$message.success(\"库存已更新\");\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    toggleStatus(row) {\n      const newStatus = row.saleStatus === '上架' ? '下架' : '上架';\n      this.$request.post('/goods/updateStockAndSaleStatus', {\n        id: row.id,\n        stock: row.stock,\n        saleStatus: newStatus\n      }).then(res => {\n        if (res.code === '200') {\n          row.saleStatus = newStatus;\n          this.$message.success(\"状态已更新为：\" + newStatus);\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    load(pageNum) {\n      if (pageNum) this.pageNum = pageNum;\n      this.$request.get('/goods/selectPage', {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize,\n          name: this.name\n        }\n      }).then(res => {\n        if (res.code === '200') {\n          this.tableData = res.data?.list || [];\n          this.total = res.data?.total;\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    reset() {\n      this.name = null;\n      this.load(1);\n    },\n    handleCurrentChange(pageNum) {\n      this.load(pageNum);\n    }\n  }\n};","map":{"version":3,"names":["name","data","tableData","pageNum","pageSize","total","content","fromVisible1","user","JSON","parse","localStorage","getItem","created","load","methods","preview","handleEdit","row","$router","push","id","del","$confirm","type","then","$request","delete","res","code","$message","success","error","msg","catch","updateStock","post","stock","saleStatus","toggleStatus","newStatus","get","params","list","reset","handleCurrentChange"],"sources":["src/views/front/Goods.vue"],"sourcesContent":["<template>\n  <div style=\"width: 70%; margin: 10px auto\" class=\"card\">\n    <el-table :data=\"tableData\" stripe>\n      <el-table-column prop=\"name\" label=\"名称\" show-overflow-tooltip></el-table-column>\n\n      <el-table-column prop=\"price\" label=\"价格\">\n        <template v-slot=\"scope\">\n          <span style=\"color: red\">￥{{ scope.row.price }}</span>\n        </template>\n      </el-table-column>\n\n      <el-table-column prop=\"stock\" label=\"库存\">\n        <template v-slot=\"scope\">\n          <el-input-number v-model=\"scope.row.stock\" size=\"mini\" :min=\"0\" />\n        </template>\n      </el-table-column>\n\n      <el-table-column prop=\"saleStatus\" label=\"上架状态\">\n        <template v-slot=\"scope\">\n          <el-tag :type=\"scope.row.saleStatus === '上架' ? 'success' : 'info'\">\n            {{ scope.row.saleStatus }}\n          </el-tag>\n        </template>\n      </el-table-column>\n\n      <el-table-column prop=\"readCount\" label=\"浏览量\"></el-table-column>\n\n      <el-table-column label=\"操作\" align=\"center\" width=\"240\">\n        <template v-slot=\"scope\">\n          <el-button size=\"mini\" type=\"primary\" plain @click=\"handleEdit(scope.row)\">编辑</el-button>\n          <el-button size=\"mini\" type=\"danger\" plain @click=\"del(scope.row.id)\">删除</el-button>\n          <el-button size=\"mini\" @click=\"updateStock(scope.row)\">更新库存</el-button>\n          <el-button size=\"mini\" type=\"warning\" @click=\"toggleStatus(scope.row)\">\n            {{ scope.row.saleStatus === '上架' ? '下架' : '上架' }}\n          </el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <div style=\"margin: 15px 0\">\n      <el-pagination\n          background\n          @current-change=\"handleCurrentChange\"\n          :current-page=\"pageNum\"\n          :page-sizes=\"[5, 10, 20]\"\n          :page-size=\"pageSize\"\n          layout=\"total, prev, pager, next\"\n          :total=\"total\">\n      </el-pagination>\n    </div>\n\n    <el-dialog title=\"内容\" :visible.sync=\"fromVisible1\" width=\"60%\" :close-on-click-modal=\"false\" destroy-on-close>\n      <div v-html=\"content\"></div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"FrontGoods\",\n  data() {\n    return {\n      tableData: [],\n      pageNum: 1,\n      pageSize: 10,\n      total: 0,\n      name: null,\n      content: '',\n      fromVisible1: false,\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n    }\n  },\n  created() {\n    this.load(1)\n  },\n  methods: {\n    preview(content) {\n      this.content = content\n      this.fromVisible1 = true\n    },\n    handleEdit(row) {\n      this.$router.push('/front/addGoods?id=' + row.id)\n    },\n    del(id) {\n      this.$confirm('您确定删除吗？', '确认删除', { type: \"warning\" }).then(() => {\n        this.$request.delete('/goods/delete/' + id).then(res => {\n          if (res.code === '200') {\n            this.$message.success('操作成功')\n            this.load(1)\n          } else {\n            this.$message.error(res.msg)\n          }\n        })\n      }).catch(() => {})\n    },\n    updateStock(row) {\n      this.$request.post('/goods/updateStockAndSaleStatus', {\n        id: row.id,\n        stock: row.stock,\n        saleStatus: row.saleStatus\n      }).then(res => {\n        if (res.code === '200') {\n          this.$message.success(\"库存已更新\");\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    toggleStatus(row) {\n      const newStatus = row.saleStatus === '上架' ? '下架' : '上架';\n      this.$request.post('/goods/updateStockAndSaleStatus', {\n        id: row.id,\n        stock: row.stock,\n        saleStatus: newStatus\n      }).then(res => {\n        if (res.code === '200') {\n          row.saleStatus = newStatus;\n          this.$message.success(\"状态已更新为：\" + newStatus);\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    load(pageNum) {\n      if (pageNum) this.pageNum = pageNum\n      this.$request.get('/goods/selectPage', {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize,\n          name: this.name,\n        }\n      }).then(res => {\n        if (res.code === '200') {\n          this.tableData = res.data?.list || []\n          this.total = res.data?.total\n        } else {\n          this.$message.error(res.msg)\n        }\n      })\n    },\n    reset() {\n      this.name = null\n      this.load(1)\n    },\n    handleCurrentChange(pageNum) {\n      this.load(pageNum)\n    }\n  }\n}\n</script>\n\n<style scoped>\n</style>\n"],"mappings":";AA0DA;EACAA,IAAA;EACAC,KAAA;IACA;MACAC,SAAA;MACAC,OAAA;MACAC,QAAA;MACAC,KAAA;MACAL,IAAA;MACAM,OAAA;MACAC,YAAA;MACAC,IAAA,EAAAC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,IAAA;EACA;EACAC,OAAA;IACAC,QAAAV,OAAA;MACA,KAAAA,OAAA,GAAAA,OAAA;MACA,KAAAC,YAAA;IACA;IACAU,WAAAC,GAAA;MACA,KAAAC,OAAA,CAAAC,IAAA,yBAAAF,GAAA,CAAAG,EAAA;IACA;IACAC,IAAAD,EAAA;MACA,KAAAE,QAAA;QAAAC,IAAA;MAAA,GAAAC,IAAA;QACA,KAAAC,QAAA,CAAAC,MAAA,oBAAAN,EAAA,EAAAI,IAAA,CAAAG,GAAA;UACA,IAAAA,GAAA,CAAAC,IAAA;YACA,KAAAC,QAAA,CAAAC,OAAA;YACA,KAAAjB,IAAA;UACA;YACA,KAAAgB,QAAA,CAAAE,KAAA,CAAAJ,GAAA,CAAAK,GAAA;UACA;QACA;MACA,GAAAC,KAAA;IACA;IACAC,YAAAjB,GAAA;MACA,KAAAQ,QAAA,CAAAU,IAAA;QACAf,EAAA,EAAAH,GAAA,CAAAG,EAAA;QACAgB,KAAA,EAAAnB,GAAA,CAAAmB,KAAA;QACAC,UAAA,EAAApB,GAAA,CAAAoB;MACA,GAAAb,IAAA,CAAAG,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAC,QAAA,CAAAC,OAAA;QACA;UACA,KAAAD,QAAA,CAAAE,KAAA,CAAAJ,GAAA,CAAAK,GAAA;QACA;MACA;IACA;IACAM,aAAArB,GAAA;MACA,MAAAsB,SAAA,GAAAtB,GAAA,CAAAoB,UAAA;MACA,KAAAZ,QAAA,CAAAU,IAAA;QACAf,EAAA,EAAAH,GAAA,CAAAG,EAAA;QACAgB,KAAA,EAAAnB,GAAA,CAAAmB,KAAA;QACAC,UAAA,EAAAE;MACA,GAAAf,IAAA,CAAAG,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACAX,GAAA,CAAAoB,UAAA,GAAAE,SAAA;UACA,KAAAV,QAAA,CAAAC,OAAA,aAAAS,SAAA;QACA;UACA,KAAAV,QAAA,CAAAE,KAAA,CAAAJ,GAAA,CAAAK,GAAA;QACA;MACA;IACA;IACAnB,KAAAX,OAAA;MACA,IAAAA,OAAA,OAAAA,OAAA,GAAAA,OAAA;MACA,KAAAuB,QAAA,CAAAe,GAAA;QACAC,MAAA;UACAvC,OAAA,OAAAA,OAAA;UACAC,QAAA,OAAAA,QAAA;UACAJ,IAAA,OAAAA;QACA;MACA,GAAAyB,IAAA,CAAAG,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAA3B,SAAA,GAAA0B,GAAA,CAAA3B,IAAA,EAAA0C,IAAA;UACA,KAAAtC,KAAA,GAAAuB,GAAA,CAAA3B,IAAA,EAAAI,KAAA;QACA;UACA,KAAAyB,QAAA,CAAAE,KAAA,CAAAJ,GAAA,CAAAK,GAAA;QACA;MACA;IACA;IACAW,MAAA;MACA,KAAA5C,IAAA;MACA,KAAAc,IAAA;IACA;IACA+B,oBAAA1C,OAAA;MACA,KAAAW,IAAA,CAAAX,OAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}