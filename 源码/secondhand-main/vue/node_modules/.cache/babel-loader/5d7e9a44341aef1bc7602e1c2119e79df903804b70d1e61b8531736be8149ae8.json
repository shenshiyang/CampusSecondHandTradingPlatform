{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport Comment from \"@/components/Comment\";\nexport default {\n  name: \"GoodsDetail\",\n  components: {\n    Comment\n  },\n  data() {\n    return {\n      id: this.$route.query.id,\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      goods: {},\n      current: '商品详情',\n      form: {},\n      fromVisible: false,\n      addressList: []\n    };\n  },\n  created() {\n    this.$request.put('/goods/updateReadCount/' + this.id).then(() => {\n      this.load();\n    });\n    this.loadAddress();\n  },\n  methods: {\n    chat(userId) {\n      this.$request.post('/chatGroup/add', {\n        chatUserId: userId,\n        userId: this.user.id\n      }).then(() => {\n        this.$router.push('/front/chat');\n      });\n    },\n    handleBuy() {\n      this.form = {};\n      this.fromVisible = true;\n    },\n    addOrder() {\n      if (!this.form.addressId) {\n        this.$message.warning('请选择收货地址');\n        return;\n      }\n      this.form.goodsId = this.id;\n      this.$request.post('/orders/add', this.form).then(res => {\n        if (res.code === '200') {\n          this.$message.success('下单成功');\n          this.$router.push('/front/orders');\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    loadAddress() {\n      this.$request.get('/address/selectAll').then(res => {\n        this.addressList = res.data || [];\n      });\n    },\n    addLikes() {\n      const isLiking = !this.goods.userLikes;\n      const messageText = isLiking ? '点赞成功' : '取消点赞成功';\n      this.$request.post('/likes/add', {\n        userId: this.user.id,\n        fid: this.goods.id,\n        module: 'goods'\n      }).then(res => {\n        if (res.code === '200') {\n          this.$message.success(messageText);\n          this.load();\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    addCollect() {\n      const isCollecting = !this.goods.userCollect;\n      const messageText = isCollecting ? '收藏成功' : '取消收藏成功';\n      this.$request.post('/collect/add', {\n        userId: this.user.id,\n        fid: this.goods.id,\n        module: 'goods',\n        goodsName: this.goods.name,\n        goodsImg: this.goods.img\n      }).then(res => {\n        if (res.code === '200') {\n          this.$message.success(messageText);\n          this.load();\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    changeItem(current) {\n      this.current = current;\n    },\n    load() {\n      this.$request.get('/goods/selectById/' + this.id).then(res => {\n        this.goods = res.data || {};\n      });\n    }\n  }\n};","map":{"version":3,"names":["Comment","name","components","data","id","$route","query","user","JSON","parse","localStorage","getItem","goods","current","form","fromVisible","addressList","created","$request","put","then","load","loadAddress","methods","chat","userId","post","chatUserId","$router","push","handleBuy","addOrder","addressId","$message","warning","goodsId","res","code","success","error","msg","get","addLikes","isLiking","userLikes","messageText","fid","module","addCollect","isCollecting","userCollect","goodsName","goodsImg","img","changeItem"],"sources":["src/views/front/GoodsDetail.vue"],"sourcesContent":["<template>\n  <div class=\"goods-detail-container\">\n    <div class=\"goods-main-content\">\n      <!-- 商品图片 -->\n      <div class=\"goods-image-container\">\n        <img :src=\"goods.img\" :alt=\"goods.name\" class=\"goods-image\">\n      </div>\n\n      <!-- 商品信息 -->\n      <div class=\"goods-info-container\">\n        <div class=\"goods-info\">\n          <h1 class=\"goods-title\">{{ goods.name }}</h1>\n\n          <div class=\"meta-info\">\n            <span class=\"meta-item\"><i class=\"el-icon-view\"></i> {{ goods.readCount }} 浏览</span>\n            <span class=\"meta-item\"><i class=\"el-icon-thumb\"></i> {{ goods.likesCount }} 点赞</span>\n            <span class=\"meta-item\"><i class=\"el-icon-star-off\"></i> {{ goods.collectCount }} 收藏</span>\n          </div>\n\n          <div class=\"price-section\">\n            <div class=\"goods-price\">\n              <span class=\"price-symbol\">¥</span>\n              <span class=\"price-value\">{{ goods.price }}</span>\n            </div>\n          </div>\n\n          <div class=\"detail-info\">\n            <div class=\"detail-line\">\n              <span class=\"detail-label\">发货地</span>\n              <span class=\"detail-value\">{{ goods.address }}</span>\n            </div>\n\n            <div class=\"detail-line seller-info\">\n              <span class=\"detail-label\">卖家</span>\n              <div class=\"seller-profile\">\n                <img :src=\"goods.userAvatar\" class=\"seller-avatar\" />\n                <span class=\"seller-name\">{{ goods.userName }}</span>\n                <el-button type=\"text\" @click=\"chat(goods.userId)\" class=\"chat-link\">\n                  <i class=\"el-icon-chat-dot-round\"></i> 联系卖家\n                </el-button>\n              </div>\n            </div>\n\n            <div class=\"detail-line\">\n              <span class=\"detail-label\">发布日期</span>\n              <span class=\"detail-value\">{{ goods.date }}</span>\n            </div>\n          </div>\n\n          <!-- 操作按钮组 -->\n          <div class=\"action-buttons\">\n            <div class=\"action-row\">\n              <el-button \n                :class=\"['action-btn', 'like-btn', {'is-active': goods.userLikes}]\"\n                @click=\"addLikes\"\n              >\n                <i :class=\"goods.userLikes ? 'el-icon-success' : 'el-icon-thumb'\"></i>\n                {{ goods.userLikes ? '已点赞' : '点赞' }}\n              </el-button>\n\n              <el-button \n                :class=\"['action-btn', 'collect-btn', {'is-active': goods.userCollect}]\"\n                @click=\"addCollect\"\n              >\n                <i :class=\"goods.userCollect ? 'el-icon-star-on' : 'el-icon-star-off'\"></i>\n                {{ goods.userCollect ? '已收藏' : '收藏' }}\n              </el-button>\n            </div>\n\n            <div class=\"action-row\">\n              <el-button \n                class=\"action-btn chat-btn\"\n                @click=\"chat(goods.userId)\"\n              >\n                <i class=\"el-icon-chat-dot-round\"></i> 联系卖家\n              </el-button>\n\n              <el-button \n                type=\"primary\"\n                class=\"action-btn buy-btn\"\n                @click=\"handleBuy\"\n              >\n                立即购买\n              </el-button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- 商品详情/评论区域 -->\n    <div class=\"goods-tabs\">\n      <div class=\"tab-header\">\n        <div \n          class=\"tab-item\" \n          :class=\"{ active: current === '商品详情' }\"\n          @click=\"changeItem('商品详情')\"\n        >\n          商品详情\n        </div>\n        <div \n          class=\"tab-item\"\n          :class=\"{ active: current === '商品评论' }\"\n          @click=\"changeItem('商品评论')\"\n        >\n          商品评论\n        </div>\n      </div>\n\n      <div class=\"tab-content\">\n        <div v-if=\"current === '商品详情'\" class=\"detail-content\" v-html=\"goods.content\"></div>\n        <div v-if=\"current === '商品评论'\" class=\"comment-content\">\n          <Comment :fid=\"id\" module=\"goods\" />\n        </div>\n      </div>\n    </div>\n\n    <!-- 下单弹窗 -->\n    <el-dialog \n      title=\"选择收货地址\" \n      :visible.sync=\"fromVisible\" \n      width=\"500px\"\n      :close-on-click-modal=\"false\"\n      destroy-on-close\n      custom-class=\"address-dialog\"\n    >\n      <div class=\"address-list\">\n        <el-radio-group v-model=\"form.addressId\">\n          <div v-for=\"item in addressList\" :key=\"item.id\" class=\"address-item\">\n            <el-radio :label=\"item.id\">\n              <div class=\"address-info\">\n                <div class=\"address-name\">{{ item.name }}</div>\n                <div class=\"address-phone\">{{ item.phone }}</div>\n                <div class=\"address-detail\">{{ item.address }}</div>\n              </div>\n            </el-radio>\n          </div>\n        </el-radio-group>\n        <div v-if=\"addressList.length === 0\" class=\"no-address\">\n          <i class=\"el-icon-location-information\"></i>\n          <p>还没有收货地址</p>\n          <el-button type=\"primary\" size=\"small\" @click=\"$router.push('/front/address')\">\n            去添加地址\n          </el-button>\n        </div>\n      </div>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"fromVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"addOrder\">确认下单</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport Comment from \"@/components/Comment\";\nexport default {\n  name: \"GoodsDetail\",\n  components: { Comment },\n  data() {\n    return {\n      id: this.$route.query.id,\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      goods: {},\n      current: '商品详情',\n      form: {},\n      fromVisible: false,\n      addressList: []\n    };\n  },\n  created() {\n    this.$request.put('/goods/updateReadCount/' + this.id).then(() => {\n      this.load();\n    });\n    this.loadAddress();\n  },\n  methods: {\n    chat(userId) {\n      this.$request.post('/chatGroup/add', { chatUserId: userId, userId: this.user.id }).then(() => {\n        this.$router.push('/front/chat');\n      });\n    },\n    handleBuy() {\n      this.form = {};\n      this.fromVisible = true;\n    },\n    addOrder() {\n      if (!this.form.addressId) {\n        this.$message.warning('请选择收货地址');\n        return;\n      }\n      this.form.goodsId = this.id;\n      this.$request.post('/orders/add', this.form).then(res => {\n        if (res.code === '200') {\n          this.$message.success('下单成功');\n          this.$router.push('/front/orders');\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    loadAddress() {\n      this.$request.get('/address/selectAll').then(res => {\n        this.addressList = res.data || [];\n      });\n    },\n    addLikes() {\n      const isLiking = !this.goods.userLikes;\n      const messageText = isLiking ? '点赞成功' : '取消点赞成功';\n      this.$request.post('/likes/add', {\n        userId: this.user.id,\n        fid: this.goods.id,\n        module: 'goods'\n      }).then(res => {\n        if (res.code === '200') {\n          this.$message.success(messageText);\n          this.load();\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    addCollect() {\n      const isCollecting = !this.goods.userCollect;\n      const messageText = isCollecting ? '收藏成功' : '取消收藏成功';\n      this.$request.post('/collect/add', {\n        userId: this.user.id,\n        fid: this.goods.id,\n        module: 'goods',\n        goodsName: this.goods.name,\n        goodsImg: this.goods.img\n      }).then(res => {\n        if (res.code === '200') {\n          this.$message.success(messageText);\n          this.load();\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    changeItem(current) {\n      this.current = current;\n    },\n    load() {\n      this.$request.get('/goods/selectById/' + this.id).then(res => {\n        this.goods = res.data || {};\n      });\n    }\n  }\n};\n</script>\n\n<style scoped>\n.goods-detail-container {\n  max-width: 1200px;\n  margin: 0 auto;\n  padding: 30px 20px;\n}\n\n.goods-main-content {\n  display: grid;\n  grid-template-columns: 450px 1fr;\n  gap: 40px;\n  margin-bottom: 40px;\n  background: #fff;\n  border-radius: 12px;\n  padding: 30px;\n  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);\n}\n\n.goods-image-container {\n  width: 450px;\n  height: 450px;\n  border-radius: 8px;\n  overflow: hidden;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n}\n\n.goods-image {\n  width: 100%;\n  height: 100%;\n  object-fit: contain;\n  background: #f8f8f8;\n  transition: transform 0.3s;\n}\n\n.goods-image:hover {\n  transform: scale(1.02);\n}\n\n.goods-info-container {\n  display: flex;\n  flex-direction: column;\n}\n\n.goods-info {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n}\n\n.goods-title {\n  font-size: 24px;\n  font-weight: 600;\n  color: #333;\n  margin: 0 0 16px;\n  line-height: 1.4;\n}\n\n.meta-info {\n  display: flex;\n  gap: 24px;\n  margin-bottom: 20px;\n  padding: 12px 0;\n  border-bottom: 1px solid #f0f0f0;\n}\n\n.meta-item {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  color: #666;\n  font-size: 14px;\n}\n\n.meta-item i {\n  color: #999;\n  font-size: 16px;\n}\n\n.price-section {\n  background: #fff9f9;\n  padding: 20px;\n  border-radius: 8px;\n  margin-bottom: 20px;\n}\n\n.goods-price {\n  display: flex;\n  align-items: baseline;\n}\n\n.price-symbol {\n  color: #ff4d4f;\n  font-size: 18px;\n  margin-right: 4px;\n}\n\n.price-value {\n  color: #ff4d4f;\n  font-size: 32px;\n  font-weight: bold;\n}\n\n.detail-info {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n  padding: 20px 0;\n  border-top: 1px solid #f0f0f0;\n  margin-top: auto;\n}\n\n.detail-line {\n  display: flex;\n  align-items: center;\n  font-size: 14px;\n}\n\n.detail-label {\n  color: #999;\n  width: 70px;\n  flex-shrink: 0;\n}\n\n.detail-value {\n  color: #333;\n  flex: 1;\n}\n\n.seller-info {\n  background: #f8f8f8;\n  padding: 16px;\n  border-radius: 8px;\n  margin: 20px 0;\n}\n\n.seller-profile {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.seller-avatar {\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  object-fit: cover;\n  border: 2px solid #fff;\n  box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n}\n\n.seller-name {\n  color: #333;\n  font-weight: 500;\n  font-size: 15px;\n}\n\n.chat-link {\n  color: #1890ff;\n  font-size: 14px;\n  padding: 0;\n}\n\n.chat-link:hover {\n  color: #40a9ff;\n}\n\n.action-buttons {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 12px;\n  margin-top: 20px;\n  padding-top: 20px;\n  border-top: 1px solid #f0f0f0;\n}\n\n.action-row {\n  display: flex;\n  gap: 12px;\n}\n\n.action-btn {\n  flex: 1;\n  height: 40px;\n  border-radius: 20px;\n  font-size: 14px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  transition: all 0.3s;\n}\n\n.action-btn i {\n  font-size: 16px;\n}\n\n.like-btn {\n  background: #fff2e8;\n  border-color: #ffbb96;\n  color: #fa541c;\n}\n\n.like-btn:hover, .like-btn.is-active {\n  background: #fa541c;\n  border-color: #fa541c;\n  color: #fff;\n}\n\n.collect-btn {\n  background: #fff7e6;\n  border-color: #ffd591;\n  color: #fa8c16;\n}\n\n.collect-btn:hover, .collect-btn.is-active {\n  background: #fa8c16;\n  border-color: #fa8c16;\n  color: #fff;\n}\n\n.chat-btn {\n  background: #e6f7ff;\n  border-color: #91d5ff;\n  color: #1890ff;\n}\n\n.chat-btn:hover {\n  background: #1890ff;\n  border-color: #1890ff;\n  color: #fff;\n}\n\n.buy-btn {\n  background: #ff4d4f;\n  border-color: #ff4d4f;\n  color: #fff;\n  font-size: 15px;\n  font-weight: 500;\n}\n\n.buy-btn:hover {\n  background: #ff7875;\n  border-color: #ff7875;\n}\n\n.goods-tabs {\n  background: #fff;\n  border-radius: 12px;\n  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);\n  overflow: hidden;\n}\n\n.tab-header {\n  display: flex;\n  background: #fafafa;\n  border-bottom: 1px solid #f0f0f0;\n}\n\n.tab-item {\n  padding: 16px 30px;\n  font-size: 15px;\n  color: #666;\n  cursor: pointer;\n  transition: all 0.3s;\n  position: relative;\n}\n\n.tab-item:hover {\n  color: #1890ff;\n}\n\n.tab-item.active {\n  color: #1890ff;\n  font-weight: 500;\n}\n\n.tab-item.active::after {\n  content: '';\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 2px;\n  background: #1890ff;\n}\n\n.tab-content {\n  min-height: 200px;\n  padding: 24px;\n}\n\n.detail-content {\n  color: #666;\n  line-height: 1.8;\n}\n\n/* 地址选择弹窗样式 */\n.address-dialog {\n  border-radius: 12px;\n}\n\n.address-list {\n  max-height: 400px;\n  overflow-y: auto;\n}\n\n.address-item {\n  padding: 16px;\n  border-bottom: 1px solid #f0f0f0;\n}\n\n.address-item:last-child {\n  border-bottom: none;\n}\n\n.address-info {\n  margin-left: 24px;\n  color: #666;\n}\n\n.address-name {\n  font-size: 15px;\n  font-weight: 500;\n  color: #333;\n  margin-bottom: 4px;\n}\n\n.address-phone {\n  font-size: 14px;\n  margin-bottom: 4px;\n}\n\n.address-detail {\n  font-size: 14px;\n  color: #999;\n}\n\n.no-address {\n  text-align: center;\n  padding: 40px 0;\n  color: #999;\n}\n\n.no-address i {\n  font-size: 48px;\n  margin-bottom: 16px;\n}\n\n.no-address p {\n  margin-bottom: 16px;\n}\n</style>\n"],"mappings":";AA2JA,OAAAA,OAAA;AACA;EACAC,IAAA;EACAC,UAAA;IAAAF;EAAA;EACAG,KAAA;IACA;MACAC,EAAA,OAAAC,MAAA,CAAAC,KAAA,CAAAF,EAAA;MACAG,IAAA,EAAAC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;MACAC,KAAA;MACAC,OAAA;MACAC,IAAA;MACAC,WAAA;MACAC,WAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,QAAA,CAAAC,GAAA,kCAAAf,EAAA,EAAAgB,IAAA;MACA,KAAAC,IAAA;IACA;IACA,KAAAC,WAAA;EACA;EACAC,OAAA;IACAC,KAAAC,MAAA;MACA,KAAAP,QAAA,CAAAQ,IAAA;QAAAC,UAAA,EAAAF,MAAA;QAAAA,MAAA,OAAAlB,IAAA,CAAAH;MAAA,GAAAgB,IAAA;QACA,KAAAQ,OAAA,CAAAC,IAAA;MACA;IACA;IACAC,UAAA;MACA,KAAAhB,IAAA;MACA,KAAAC,WAAA;IACA;IACAgB,SAAA;MACA,UAAAjB,IAAA,CAAAkB,SAAA;QACA,KAAAC,QAAA,CAAAC,OAAA;QACA;MACA;MACA,KAAApB,IAAA,CAAAqB,OAAA,QAAA/B,EAAA;MACA,KAAAc,QAAA,CAAAQ,IAAA,qBAAAZ,IAAA,EAAAM,IAAA,CAAAgB,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAJ,QAAA,CAAAK,OAAA;UACA,KAAAV,OAAA,CAAAC,IAAA;QACA;UACA,KAAAI,QAAA,CAAAM,KAAA,CAAAH,GAAA,CAAAI,GAAA;QACA;MACA;IACA;IACAlB,YAAA;MACA,KAAAJ,QAAA,CAAAuB,GAAA,uBAAArB,IAAA,CAAAgB,GAAA;QACA,KAAApB,WAAA,GAAAoB,GAAA,CAAAjC,IAAA;MACA;IACA;IACAuC,SAAA;MACA,MAAAC,QAAA,SAAA/B,KAAA,CAAAgC,SAAA;MACA,MAAAC,WAAA,GAAAF,QAAA;MACA,KAAAzB,QAAA,CAAAQ,IAAA;QACAD,MAAA,OAAAlB,IAAA,CAAAH,EAAA;QACA0C,GAAA,OAAAlC,KAAA,CAAAR,EAAA;QACA2C,MAAA;MACA,GAAA3B,IAAA,CAAAgB,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAJ,QAAA,CAAAK,OAAA,CAAAO,WAAA;UACA,KAAAxB,IAAA;QACA;UACA,KAAAY,QAAA,CAAAM,KAAA,CAAAH,GAAA,CAAAI,GAAA;QACA;MACA;IACA;IACAQ,WAAA;MACA,MAAAC,YAAA,SAAArC,KAAA,CAAAsC,WAAA;MACA,MAAAL,WAAA,GAAAI,YAAA;MACA,KAAA/B,QAAA,CAAAQ,IAAA;QACAD,MAAA,OAAAlB,IAAA,CAAAH,EAAA;QACA0C,GAAA,OAAAlC,KAAA,CAAAR,EAAA;QACA2C,MAAA;QACAI,SAAA,OAAAvC,KAAA,CAAAX,IAAA;QACAmD,QAAA,OAAAxC,KAAA,CAAAyC;MACA,GAAAjC,IAAA,CAAAgB,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAJ,QAAA,CAAAK,OAAA,CAAAO,WAAA;UACA,KAAAxB,IAAA;QACA;UACA,KAAAY,QAAA,CAAAM,KAAA,CAAAH,GAAA,CAAAI,GAAA;QACA;MACA;IACA;IACAc,WAAAzC,OAAA;MACA,KAAAA,OAAA,GAAAA,OAAA;IACA;IACAQ,KAAA;MACA,KAAAH,QAAA,CAAAuB,GAAA,6BAAArC,EAAA,EAAAgB,IAAA,CAAAgB,GAAA;QACA,KAAAxB,KAAA,GAAAwB,GAAA,CAAAjC,IAAA;MACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}